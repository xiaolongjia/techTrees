618.(Hard) Students Report By Geography
https://leetcode.com/problems/students-report-by-geography

====================================================================
618.(Hard) Students Report By Geography. 纵表转横表
================================================================================

student
| name   | continent |
|--------|-----------|
| Jack   | America   |
| Pascal | Europe    |
| Xi     | Asia      |
| Jane   | America   |

output
| America | Asia | Europe |
|---------|------|--------|
| Jack    | Xi   | Pascal |
| Jane    |      |        |

========================
schema:
========================
Create table H_618_student (name varchar(50), continent varchar(50));
Truncate table H_618_student;
insert into H_618_student (name , continent) values ('Jack', 'America');
insert into H_618_student (name , continent) values ('Pascal', 'Europe');
insert into H_618_student (name , continent) values ('Xi', 'Asia');
insert into H_618_student (name , continent) values ('Jane', 'America');

========================
solution:
========================

========================
TSQL:
========================

with a as (
select row_number() over (order by name) as id, name as America
from H_618_student
where continent = 'America'),
e as (
select row_number() over (order by name) as id, name as Europe
from H_618_student
where continent = 'Europe'),
asia as (
select row_number() over (order by name) as id, name as Asia
from H_618_student
where continent = 'Asia')
select 
America, Europe, Asia
from a
left join e on a.id = e.id 
left join asia on a.id = asia.id 



SELECT America, Asia, Europe
FROM(
    SELECT 
		continentorder,
		MAX(CASE WHEN continent = 'America' THEN name END )AS America,
		MAX(CASE WHEN continent = 'Europe' THEN name END )AS Europe,
		MAX(CASE WHEN continent = 'Asia' THEN name END )AS Asia
    FROM (
        SELECT *,
        ROW_NUMBER()OVER(PARTITION BY continent ORDER BY name) AS continentorder
        FROM H_618_student
        ) AS SOURCE
    GROUP BY continentorder
)temp


========================
MYSQL:  ?????
========================

SELECT America, Asia, Europe
FROM ( 
	SELECT 
		continentorder,
		MAX(CASE WHEN continent = 'America' THEN name END )AS America,
		MAX(CASE WHEN continent = 'Europe' THEN name END )AS Europe,
		MAX(CASE WHEN continent = 'Asia' THEN name END )AS Asia
	FROM (
		SELECT *,   // ???????
		@counter := @counter + 1  continentorder
		FROM H_618_student, (select @counter := 0) r
		order by continent) source
	GROUP BY continentorder
) temp

